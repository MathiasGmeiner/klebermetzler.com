---
import type { Page } from "@/types";
import { Image } from "astro:assets";

const page: Page = Astro.props.page;
---

<div class="swiper">
  <div class="swiper-wrapper">
    {
      page.content.slider?.map((item) => {
        const { mobile, desktop } = item.image;
        return (
          <div class="swiper-slide item">
            <div class="image">
              <Image
                src={mobile.src}
                alt={mobile.alt}
                width={mobile.width}
                height={mobile.height}
                widths={[320, 400, 640, 800, 1000]}
                sizes="100vw"
                class="mobile"
              />
              <Image
                src={desktop.src}
                alt={desktop.alt}
                width={desktop.width}
                height={desktop.height}
                widths={[800, 1000, 1200, 1400, 1800, 2000, 2400]}
                sizes="100vw"
                class="desktop"
              />
              {item.caption && (
                <div class="caption fd-subtitle">{item.caption}</div>
              )}
            </div>
            <a
              class="link"
              href={item.link.href}
              aria-label={item.link.title}
            />
          </div>
        );
      })
    }
  </div>
  <div class="swiper-button-prev"></div>
  <div class="swiper-button-next"></div>
</div>

<script>
  import Swiper from "swiper";
  import { Navigation } from "swiper/modules";
  import "swiper/css";
  import "swiper/css/navigation";

  const swiper = new Swiper(".swiper", {
    modules: [Navigation],
    loop: true,
    navigation: {
      nextEl: ".swiper-button-next",
      prevEl: ".swiper-button-prev",
    },
  });
</script>

<style>
  .swiper-button-prev {
    position: absolute;
    top: 50%;
    left: 1rem;
    transform: translateY(-50%);
    z-index: 10;
    width: 2rem;
    height: 2rem;
    background: var(--color-black);
  }
  .item {
    width: 100%;
    height: 100vh;
    position: relative;

    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .image {
      position: relative;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .mobile {
      @screen md {
        display: none;
      }
    }

    .desktop {
      display: none;

      @screen md {
        display: block;
      }
    }

    .link {
      position: absolute;
      inset: 0;
      pointer-events: auto;
    }
  }

  .caption {
    position: absolute;
    left: 2.5rem;
    bottom: 5rem;
    color: #fff;
    text-shadow:
      1px 0 0 var(--color-black),
      -1px 0 0 var(--color-black),
      0 1px 0 var(--color-black),
      0 -1px 0 var(--color-black);

    @screen md {
      bottom: 1.25rem;
    }
  }
</style>
